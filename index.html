<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>My Heart üç´</title>
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Playfair+Display:ital,wght@0,400;1,400&family=Poppins:wght@300;500&display=swap" rel="stylesheet">
    
    <style>
        /* --- RESET & LAYOUT --- */
        * { box-sizing: border-box; margin: 0; padding: 0; -webkit-tap-highlight-color: transparent; user-select: none; }

        body {
            height: 100vh;
            width: 100vw;
            background: #1a0f0a; /* Deep Chocolate */
            font-family: 'Poppins', sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            color: #eaddcf;
            position: relative;
        }

        /* Animated Background */
        .bg-pattern {
            position: absolute; width: 100%; height: 100%;
            background-image: radial-gradient(#3e2723 15%, transparent 16%), radial-gradient(#3e2723 15%, transparent 16%);
            background-size: 60px 60px;
            background-position: 0 0, 30px 30px;
            opacity: 0.1;
            z-index: 0;
            animation: moveBg 20s linear infinite;
        }
        @keyframes moveBg { 0% { background-position: 0 0, 30px 30px; } 100% { background-position: 60px 60px, 90px 90px; } }

        /* --- THE STAGE CONTAINER --- */
        .stage-container {
            position: relative;
            width: 320px;
            height: 450px;
            z-index: 10;
            perspective: 1000px;
        }

        /* COMMON CARD STYLES */
        .layer {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            border-radius: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 20px;
            box-shadow: 0 20px 50px rgba(0,0,0,0.5);
            transition: all 0.8s cubic-bezier(0.25, 0.8, 0.25, 1);
            backface-visibility: hidden;
        }

        /* --- LAYER 1: GOLD FOIL (SWIPE) --- */
        .layer-foil {
            background: linear-gradient(135deg, #bf953f, #fcf6ba, #b38728, #fbf5b7, #aa771c);
            z-index: 4;
            border: 1px solid #fff;
            cursor: grab;
        }
        .layer-foil::before {
            content: ''; position: absolute; top:0; left:0; width:100%; height:100%;
            background: repeating-linear-gradient(45deg, rgba(0,0,0,0.05) 0px, rgba(0,0,0,0.05) 2px, transparent 2px, transparent 4px);
        }
        .sticker {
            width: 80px; height: 80px; background: #3e2723; border-radius: 50%;
            display: flex; justify-content: center; align-items: center;
            border: 2px solid #d4af37; box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            font-family: 'Dancing Script'; font-size: 1.5rem; color: #d4af37;
        }

        /* --- LAYER 2: HARD SHELL (TAP) --- */
        .layer-shell {
            background: linear-gradient(135deg, #2b1d1a, #1a0f0a);
            z-index: 3;
            border: 1px solid #5d4037;
        }
        .crack-svg {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none; opacity: 0; transition: opacity 0.1s;
        }
        .crack-path { fill: none; stroke: rgba(255,255,255,0.2); stroke-width: 2; stroke-linecap: round; }

        /* --- LAYER 3: MELTING (HOLD) --- */
        .layer-melt {
            background: linear-gradient(135deg, #795548, #5d4037);
            z-index: 2;
            transition: opacity 0.1s; /* Fast visual update for melting */
        }
        .melt-overlay {
            position: absolute; top:0; left:0; width:100%; height:100%;
            background: radial-gradient(circle, rgba(255,100,100,0.4), transparent);
            opacity: 0; pointer-events: none;
        }

        /* --- LAYER 4: THE CORE (PHOTO & LETTER) --- */
        .layer-core {
            background: #fff;
            z-index: 1;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            justify-content: flex-start; /* Align top */
            padding: 0;
        }
        
        .photo-area {
            width: 100%;
            height: 50%;
            /* --- REPLACE LINK HERE --- */
            background-image: url('https://images.unsplash.com/photo-1518199266791-5375a83190b7?q=80&w=1000&auto=format&fit=crop');
            background-size: cover;
            background-position: center;
            position: relative;
        }
        
        .letter-area {
            width: 100%;
            height: 50%;
            padding: 20px;
            overflow-y: auto; /* Allow scrolling */
            background: #fff0f5;
            color: #333;
            font-family: 'Dancing Script', cursive;
            font-size: 1.2rem;
            line-height: 1.5;
            text-align: left;
            position: relative;
        }

        /* --- TEXT & UI --- */
        .instruction {
            position: absolute;
            bottom: 30px;
            font-size: 1rem;
            text-transform: uppercase;
            letter-spacing: 2px;
            animation: pulse 2s infinite;
            pointer-events: none;
        }
        @keyframes pulse { 0%, 100% { opacity: 0.6; } 50% { opacity: 1; } }

        .progress-bar {
            position: absolute; top: 20px; left: 20px; right: 20px;
            height: 4px; background: rgba(255,255,255,0.2); border-radius: 10px;
            overflow: hidden; opacity: 0; transition: opacity 0.5s;
        }
        .progress-fill { height: 100%; width: 0%; background: #ff4b2b; }

        /* Shake Animation */
        .shake { animation: shake 0.4s cubic-bezier(.36,.07,.19,.97) both; }
        @keyframes shake { 10%, 90% { transform: translate3d(-1px, 0, 0); } 20%, 80% { transform: translate3d(2px, 0, 0); } 30%, 50%, 70% { transform: translate3d(-4px, 0, 0); } 40%, 60% { transform: translate3d(4px, 0, 0); } }

        /* Removed Classes */
        .swiped-right { transform: translateX(120%) rotate(20deg); opacity: 0; }
        .shattered { transform: scale(1.1); opacity: 0; }
        .melted { opacity: 0; pointer-events: none; }

        /* Floating Hearts */
        .heart { position: absolute; color: #d4af37; font-size: 20px; animation: floatUp 3s linear forwards; pointer-events: none; z-index: 50; }
        @keyframes floatUp { to { transform: translateY(-200px); opacity: 0; } }

        /* WhatsApp Button */
        .wa-btn {
            display: block; margin-top: 15px; text-align: center;
            background: #25D366; color: white; padding: 10px 20px;
            border-radius: 20px; text-decoration: none; font-family: 'Poppins'; font-size: 0.9rem;
            box-shadow: 0 5px 10px rgba(0,0,0,0.1);
        }

    </style>
</head>
<body>

    <div class="bg-pattern"></div>

    <div class="stage-container">

        <div class="layer layer-core" id="layer4">
            <div class="photo-area">
                <div style="position:absolute; bottom:0; width:100%; height:50%; background:linear-gradient(transparent, #fff0f5);"></div>
            </div>
            <div class="letter-area">
                <p><b>My Dearest,</b></p>
                <p>Just like this chocolate, my heart has layers. But you... you are the only one who has ever reached the center.</p>
                <p>Thank you for breaking down my walls and melting my heart every single day.</p>
                <p>You are my sweetest addiction.</p>
                <br>
                <p style="text-align: right;">- Yours Forever ‚ù§Ô∏è</p>
                <a href="#" id="wa-link" class="wa-btn">I reached the center! üç´</a>
            </div>
        </div>

        <div class="layer layer-melt" id="layer3" 
             onmousedown="startMelt()" onmouseup="stopMelt()" 
             ontouchstart="startMelt()" ontouchend="stopMelt()">
            <h2>Soft Heart</h2>
            <p style="font-size: 0.9rem; margin-top:10px; opacity:0.8;">You make me soft...</p>
            <div class="melt-overlay" id="melt-overlay"></div>
            <div class="instruction">Hold to Melt</div>
            <div class="progress-bar" style="opacity: 1;"><div class="progress-fill" id="melt-bar"></div></div>
        </div>

        <div class="layer layer-shell" id="layer2" onclick="crackShell()">
            <h2 style="color: #d4af37;">Tough Exterior</h2>
            <p style="font-size: 0.9rem; margin-top:10px; opacity:0.8;">I put up walls sometimes...</p>
            <div class="instruction">Tap to Break</div>
            <svg class="crack-svg" viewBox="0 0 100 100" id="cracks">
                <path class="crack-path" d="M50 0 L40 30 L60 50 L30 80 L50 100" />
                <path class="crack-path" d="M0 50 L30 40 L50 60 L80 40 L100 50" />
            </svg>
        </div>

        <div class="layer layer-foil" id="layer1">
            <div class="sticker">For You</div>
            <div class="instruction">Swipe Right ‚ûú</div>
        </div>

    </div>

    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <script>
        // --- CONFIG ---
        const yourPhoneNumber = "917795253497"; 

        // --- LAYER 1: SWIPE LOGIC ---
        const layer1 = document.getElementById('layer1');
        let startX = 0;

        layer1.addEventListener('touchstart', (e) => startX = e.touches[0].clientX);
        layer1.addEventListener('touchmove', (e) => {
            let diff = e.touches[0].clientX - startX;
            if (diff > 0) layer1.style.transform = `translateX(${diff}px) rotate(${diff/20}deg)`;
        });
        layer1.addEventListener('touchend', (e) => {
            let diff = e.changedTouches[0].clientX - startX;
            if (diff > 100) {
                layer1.classList.add('swiped-right'); // Success
                createParticles('‚ú®');
            } else {
                layer1.style.transform = 'translateX(0)'; // Reset
            }
        });
        // Mouse support for desktop testing
        layer1.addEventListener('mousedown', (e) => startX = e.clientX);
        layer1.addEventListener('mouseup', (e) => {
            let diff = e.clientX - startX;
            if (diff > 100) {
                layer1.classList.add('swiped-right'); 
                createParticles('‚ú®');
            } else {
                layer1.style.transform = 'translateX(0)';
            }
        });


        // --- LAYER 2: CRACK LOGIC ---
        const layer2 = document.getElementById('layer2');
        const cracks = document.getElementById('cracks');
        let taps = 0;

        function crackShell() {
            taps++;
            
            // Shake effect
            layer2.classList.remove('shake');
            void layer2.offsetWidth;
            layer2.classList.add('shake');

            // Haptic
            if(navigator.vibrate) navigator.vibrate(50);

            // Visual Damage
            if (taps === 2) cracks.style.opacity = 0.3;
            if (taps === 4) cracks.style.opacity = 0.6;
            if (taps === 6) cracks.style.opacity = 1;

            if (taps >= 8) {
                layer2.classList.add('shattered');
                createParticles('üç´');
            }
        }


        // --- LAYER 3: MELT LOGIC ---
        const layer3 = document.getElementById('layer3');
        const meltBar = document.getElementById('melt-bar');
        const meltOverlay = document.getElementById('melt-overlay');
        let heat = 0;
        let isHolding = false;
        let meltInterval;

        function startMelt() {
            isHolding = true;
            meltInterval = setInterval(() => {
                heat += 1;
                meltBar.style.width = heat + "%";
                layer3.style.opacity = (100 - heat) / 100; // Fade out
                meltOverlay.style.opacity = heat / 200; // Red glow

                createParticles('‚ù§Ô∏è'); // Hearts flying

                if (heat >= 100) {
                    finishExperience();
                }
            }, 30);
        }

        function stopMelt() {
            isHolding = false;
            clearInterval(meltInterval);
        }

        function finishExperience() {
            clearInterval(meltInterval);
            layer3.classList.add('melted');
            
            // Final Celebration
            confetti({ particleCount: 150, spread: 80, origin: { y: 0.6 }, colors: ['#d4af37', '#ff4b2b'] });

            // Setup WhatsApp
            const msg = "I unwrapped the layers, broke the shell, melted your heart, and found the letter! üç´‚ù§Ô∏è Happy Chocolate Day!";
            document.getElementById('wa-link').href = `https://wa.me/${yourPhoneNumber}?text=${encodeURIComponent(msg)}`;
        }


        // --- UTILS: PARTICLES ---
        function createParticles(emoji) {
            const el = document.createElement('div');
            el.innerText = emoji;
            el.style.position = 'fixed';
            el.style.left = Math.random() * 80 + 10 + '%';
            el.style.top = '50%';
            el.style.fontSize = '2rem';
            el.style.pointerEvents = 'none';
            el.style.animation = 'floatUp 1s forwards';
            el.style.zIndex = 100;
            document.body.appendChild(el);
            setTimeout(() => el.remove(), 1000);
        }

    </style>
</body>
</html>
